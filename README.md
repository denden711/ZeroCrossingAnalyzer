# ZeroCrossingAnalyzer

**ZeroCrossingAnalyzer**は、複数のCSVファイルから電圧のゼロ交差点（電圧が0を通過する瞬間）を検出し、その結果をExcelファイルに出力するツールです。電圧が0を通過する時刻、周期、および方向（上昇または下降）を記録します。

## 主な機能
- 複数のCSVファイルを一度に処理可能
- 電圧のゼロ交差点を指定した時間間隔ごとに記録
- 出力ファイルは、選択したCSVファイルの保存先と同じフォルダに保存
- 各CSVファイルごとにExcelファイルの異なるシートに出力
- 出力ファイル名に処理対象のCSVファイル名と処理時の時刻を含む

## インストール

1. まず、必要なパッケージをインストールします。`pandas`と`xlsxwriter`を使用します。

```bash
pip install pandas xlsxwriter
```

## 使用方法

1. プログラムを実行します。ファイル選択ダイアログが表示されるので、1つまたは複数のCSVファイルを選択します。

```bash
python ZeroCrossingAnalyzer.py
```

2. 各CSVファイルについて、電圧が0を通過した時刻、周期、方向が計算され、結果がExcelファイルとして保存されます。

### 実行コマンド例
```bash
python ZeroCrossingAnalyzer.py
```

### 出力ファイル名
出力ファイルは、選択したCSVファイルの保存先に以下の形式で保存されます。

```
zero_crossing_results_<CSVファイル名>_<日時>.xlsx
```

例:
```
zero_crossing_results_samplefile_20241010_153045.xlsx
```

複数のファイルを処理する場合は、最初に選択したファイル名を使い、`_and_others`がファイル名に追加されます。

## CSVファイルのフォーマット

CSVファイルは、4列目に時間、5列目に電圧のデータが含まれている必要があります。

- **4列目**: 時間
- **5列目**: 電圧

## 出力内容
Excelファイルの各シートには、次の列が含まれます。

- **ファイル名**: 処理されたCSVファイルの名前
- **時刻**: ゼロ交差点の発生時刻
- **周期**: ゼロ交差点が発生した周期
- **方向**: 上昇（プラスに向かう）か下降（マイナスに向かう）

## 設定のカスタマイズ

### 時間間隔の設定
電圧が不安定で頻繁にゼロ交差点が発生する場合、指定した時間間隔が経過した後に最初のゼロ交差点のみを記録します。この時間間隔は、プログラム内の`TIME_INTERVAL_THRESHOLD`で設定できます。

デフォルトでは0.00002秒が設定されています。

```python
TIME_INTERVAL_THRESHOLD = 0.00002
```

### エラーハンドリング

プログラムには以下のエラーハンドリングが実装されています。

- **ファイル選択エラー**: CSVファイルが選択されなかった場合、適切なメッセージが表示されます。
- **CSVファイルフォーマットエラー**: 時間や電圧の列が不足している場合、エラーメッセージが表示されます。
- **Excelファイル保存エラー**: ファイルが既に開かれている場合や保存権限がない場合、エラーメッセージが表示されます。

## ライセンス

このプロジェクトはMITライセンスの下で公開されています。
