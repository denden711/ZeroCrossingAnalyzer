# ZeroCrossingAnalyzer

ZeroCrossingAnalyzer は、複数のCSVファイルから電圧のゼロ交差点（ゼロを通過する点）を計算し、その結果をExcelファイルに出力するツールです。出力ファイルには、各ゼロ交差点の時刻、周期、方向（上昇または下降）、および元のCSVファイル名が記録されます。

## 主な機能
- 複数のCSVファイルを処理
- 電圧のゼロ交差点の時刻を高精度で計算
- 指定した時間間隔が空いてから次のゼロ交差点を記録
- 各CSVファイルごとに結果をExcelファイルの異なるシートに出力
- 出力ファイル名には、処理したCSVファイル名と現在の時刻を追加

## 使用方法

### 1. 依存パッケージのインストール
本ツールは、以下のPythonパッケージに依存しています。インストールされていない場合は、以下のコマンドを使用してインストールしてください。

```bash
pip install pandas xlsxwriter
```

### 2. プログラムの実行
Pythonファイルを実行すると、ファイル選択ダイアログが表示されます。複数のCSVファイルを選択可能です。選択したCSVファイルは順番に処理され、各ファイルのゼロ交差点のデータがExcelファイルに出力されます。

#### 実行コマンド例
```bash
python ZeroCrossingAnalyzer.py
```

### 3. 結果の出力
処理が完了すると、結果がExcelファイルとして保存されます。ファイル名には、最初に選択したCSVファイル名と処理時の時刻が含まれます。

例:
```
zero_crossing_results_samplefile_20241010_153045.xlsx
```

### 4. 出力データの形式
出力されたExcelファイルには、以下の列が含まれます。

- **ファイル名**: 処理したCSVファイルの名前
- **時刻**: ゼロ交差点の発生時刻
- **周期**: ゼロ交差点が発生した周期
- **方向**: ゼロ交差点の発生時に電圧が上昇または下降しているか

各CSVファイルの結果は、Excelの異なるシートに分かれて保存されます。

## 設定の変更
時間間隔や他の設定を変更する場合、以下の変数を修正してください。

### 時間間隔の設定
電圧の変動が安定しない場合、ゼロ交差点の記録を間隔を空けて行うように設定しています。この時間間隔は、プログラム内の`TIME_INTERVAL_THRESHOLD`で制御されています。

```python
# デフォルト値は0.00002秒
TIME_INTERVAL_THRESHOLD = 0.00002
```

## 注意点
- CSVファイルの形式は、4列目に時間、5列目に電圧のデータがあることが前提です。
- CSVファイルはエンコーディングが`shift_jis`であることを前提としていますが、他のエンコーディングが必要な場合は適宜変更してください。

## ライセンス
このプロジェクトはMITライセンスの下で公開されています。
```

### 説明
- **依存パッケージのインストール**: `pandas`と`xlsxwriter`のインストール方法を説明しています。
- **プログラムの実行**: プログラムの実行手順を説明しています。
- **出力ファイル名と内容**: 出力されるExcelファイルの形式とファイル名について説明しています。
- **時間間隔の設定**: `TIME_INTERVAL_THRESHOLD`を設定する方法を記載しています。